KindEditor.plugin("flash",function(m){var k=this,t="flash",s=k.lang(t+"."),q=m.undef(k.allowFlashUpload,true),l=m.undef(k.allowFileManager,false),n=m.undef(k.formatUploadUrl,true),o=m.undef(k.extraFileUploadParams,{}),r=m.undef(k.filePostName,"imgFile"),p=m.undef(k.uploadJson,k.basePath+"php/upload_json.php");k.plugin.flash={edit:function(){var d=['<div style="padding:20px;">','<div class="ke-dialog-row">','<label for="keUrl" style="width:60px;">'+s.url+"</label>",'<input class="ke-input-text" type="text" id="keUrl" name="url" value="" style="width:160px;" /> &nbsp;','<input type="button" class="ke-upload-button" value="'+s.upload+'" /> &nbsp;','<span class="ke-button-common ke-button-outer">','<input type="button" class="ke-button-common ke-button" name="viewServer" value="'+s.viewServer+'" />',"</span>","</div>",'<div class="ke-dialog-row">','<label for="keWidth" style="width:60px;">'+s.width+"</label>",'<input type="text" id="keWidth" class="ke-input-text ke-input-number" name="width" value="550" maxlength="4" /> ',"</div>",'<div class="ke-dialog-row">','<label for="keHeight" style="width:60px;">'+s.height+"</label>",'<input type="text" id="keHeight" class="ke-input-text ke-input-number" name="height" value="400" maxlength="4" /> ',"</div>","</div>"].join("");var b=k.createDialog({name:t,width:450,title:k.lang(t),body:d,yesBtn:{name:k.lang("yes"),click:function(D){var B=m.trim(f.val()),z=c.val(),C=a.val();if(B=="http://"||m.invalidUrl(B)){alert(k.lang("invalidUrl"));f[0].focus();return}if(!/^\d*$/.test(z)){alert(k.lang("invalidWidth"));c[0].focus();return}if(!/^\d*$/.test(C)){alert(k.lang("invalidHeight"));a[0].focus();return}var A=m.mediaImg(k.themesPath+"common/blank.gif",{src:B,type:m.mediaType(".swf"),width:z,height:C,quality:"high"});k.insertHtml(A).hideDialog().focus()}}}),h=b.div,f=m('[name="url"]',h),g=m('[name="viewServer"]',h),c=m('[name="width"]',h),a=m('[name="height"]',h);f.val("http://");if(q){var i=m.uploadbutton({button:m(".ke-upload-button",h)[0],fieldName:r,extraParams:o,url:m.addParam(p,"dir=flash"),afterUpload:function(w){b.hideLoading();if(w.error===0){var x=w.url;if(n){x=m.formatUrl(x,"absolute")}f.val(x);if(k.afterUpload){k.afterUpload.call(k,x,w,t)}alert(k.lang("uploadSuccess"))}else{alert(w.message)}},afterError:function(v){b.hideLoading();k.errorDialog(v)}});i.fileBox.change(function(v){b.showLoading(k.lang("uploadLoading"));i.submit()})}else{m(".ke-upload-button",h).hide()}if(l){g.click(function(v){k.loadPlugin("filemanager",function(){k.plugin.filemanagerDialog({viewType:"LIST",dirName:"flash",clickFn:function(x,u){if(k.dialogs.length>1){m('[name="url"]',h).val(x);if(k.afterSelectFile){k.afterSelectFile.call(k,x)}k.hideDialog()}}})})})}else{g.hide()}var e=k.plugin.getSelectedFlash();if(e){var j=m.mediaAttrs(e.attr("data-ke-tag"));f.val(j.src);c.val(m.removeUnit(e.css("width"))||j.width||0);a.val(m.removeUnit(e.css("height"))||j.height||0)}f[0].focus();f[0].select()},"delete":function(){k.plugin.getSelectedFlash().remove();k.addBookmark()}};k.clickToolbar(t,k.plugin.flash.edit)});