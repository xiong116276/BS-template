KindEditor.plugin("emoticons",function(h){var g=this,l="emoticons",i=(g.emoticonsPath||g.pluginsPath+"emoticons/images/"),j=g.allowPreviewEmoticons===undefined?true:g.allowPreviewEmoticons,k=1;g.clickToolbar(l,function(){var C=5,B=9,a=135,K=0,G=C*B,A=Math.ceil(a/G),b=Math.floor(B/2),H=h('<div class="ke-plugin-emoticons"></div>'),z=[],I=g.createMenu({name:l,beforeRemove:function(){e()}});I.div.append(H);var f,F;if(j){f=h('<div class="ke-preview"></div>').css("right",0);F=h('<img class="ke-preview-img" src="'+i+K+'.gif" />');H.append(f);f.append(F)}function c(n,o,m){if(f){n.mouseover(function(){if(o>b){f.css("left",0);f.css("right","")}else{f.css("left","");f.css("right",0)}F.attr("src",i+m+".gif");h(this).addClass("ke-on")})}else{n.mouseover(function(){h(this).addClass("ke-on")})}n.mouseout(function(){h(this).removeClass("ke-on")});n.click(function(p){g.insertHtml('<img src="'+i+m+'.gif" border="0" alt="" />').hideMenu().focus();p.stop()})}function E(m,q){var s=document.createElement("table");q.append(s);if(f){h(s).mouseover(function(){f.show("block")});h(s).mouseout(function(){f.hide()});z.push(h(s))}s.className="ke-table";s.cellPadding=0;s.cellSpacing=0;s.border=0;var n=(m-1)*G+K;for(var o=0;o<C;o++){var r=s.insertRow(o);for(var p=0;p<B;p++){var t=h(r.insertCell(p));t.addClass("ke-cell");c(t,p,n);var u=h('<span class="ke-img"></span>').css("background-position","-"+(24*n)+"px 0px").css("background-image","url("+i+"static.gif)");t.append(u);z.push(t);n++}}return s}var d=E(k,H);function e(){h.each(z,function(){this.unbind()})}var J;function L(n,m){n.click(function(o){e();d.parentNode.removeChild(d);J.remove();d=E(m,H);D(m);k=m;o.stop()})}function D(m){J=h('<div class="ke-page"></div>');H.append(J);for(var o=1;o<=A;o++){if(m!==o){var n=h('<a href="javascript:;">['+o+"]</a>");L(n,o);J.append(n);z.push(n)}else{J.append(h("@["+o+"]"))}J.append(h("@&nbsp;"))}}D(k)})});