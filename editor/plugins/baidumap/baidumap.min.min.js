KindEditor.plugin("baidumap",function(h){var g=this,k="baidumap",i=g.lang(k+".");var l=h.undef(g.mapWidth,558);var j=h.undef(g.mapHeight,360);g.clickToolbar(k,function(){var r=['<div style="padding:10px 20px;">','<div class="ke-header">','<div class="ke-left">',i.address+' <input id="kindeditor_plugin_map_address" name="address" class="ke-input-text" value="" style="width:200px;" /> ','<span class="ke-button-common ke-button-outer">','<input type="button" name="searchBtn" class="ke-button-common ke-button" value="'+i.search+'" />',"</span>","</div>",'<div class="ke-right">','<input type="checkbox" id="keInsertDynamicMap" name="insertDynamicMap" value="1" /> <label for="keInsertDynamicMap">'+i.insertDynamicMap+"</label>","</div>",'<div class="ke-clearfix"></div>',"</div>",'<div class="ke-map" style="width:'+l+"px;height:"+j+'px;"></div>',"</div>"].join("");var c=g.createDialog({name:k,width:l+42,title:g.lang(k),body:r,yesBtn:{name:g.lang("yes"),click:function(m){var n=e.map;var o=n.getCenter();var x=o.lng+","+o.lat;var p=n.getZoom();var w=[f[0].checked?g.pluginsPath+"baidumap/01index.html":"http://api.map.baidu.com/staticimage","?center="+encodeURIComponent(x),"&zoom="+encodeURIComponent(p),"&width="+l,"&height="+j,"&markers="+encodeURIComponent(x),"&markerStyles="+encodeURIComponent("l,A")].join("");if(f[0].checked){g.insertHtml('<iframe src="'+w+'" frameborder="0" style="width:'+(l+2)+"px;height:"+(j+2)+'px;"></iframe>')}else{g.exec("insertimage",w)}g.hideDialog().focus()}},beforeRemove:function(){d.remove();if(a){a.write("")}s.remove()}});var t=c.div,q=h('[name="address"]',t),d=h('[name="searchBtn"]',t),f=h('[name="insertDynamicMap"]',c.div),e,a;var s=h('<iframe class="ke-textarea" frameborder="0" src="'+g.pluginsPath+'baidumap/map.html" style="width:'+l+"px;height:"+j+'px;"></iframe>');function b(){e=s[0].contentWindow;a=h.iframeDoc(s)}s.bind("load",function(){s.unbind("load");if(h.IE){b()}else{setTimeout(b,0)}});h(".ke-map",t).replaceWith(s);d.click(function(){e.search(q.val())})})});